---
nest::classes:
  - 'nest::firmware::raspberrypi'

nest::autologin: sway
nest::bootloader: u-root
nest::dtb_file: 'broadcom/bcm2712-rpi-5-b.dtb'
nest::dvorak: true
nest::fscache: false
nest::kernel_defconfig: 'bcm2712_defconfig'
nest::kernel_tag: 'raspberrypi/v6.12.49'
nest::swap_alt_win: true
nest::uroot_delay: 1
nest::wifi: true
nest::wifi_power_save: false

nest::kernel_cmdline:
  - '8250.nr_uarts=1' # set in DT but not passed by u-root (for bluetooth)
  - 'console=ttyAMA0,115200n8'
  - 'console=tty0'

nest::kernel_config:
  # System drivers ('Y' for inclusion in u-root kernel)
  CONFIG_KEXEC_FILE: Y

  # Device drivers ('y' for early boot)
  CONFIG_DRM: y
  CONFIG_DRM_V3D: y
  CONFIG_DRM_VC4: y
  CONFIG_SND: y
  CONFIG_SND_SOC: y
  CONFIG_V4L_MEM2MEM_DRIVERS: y

  # Enable frequency scaling based on scheduler data
  CONFIG_CPU_FREQ_DEFAULT_GOV_ONDEMAND: n
  CONFIG_CPU_FREQ_DEFAULT_GOV_SCHEDUTIL: y

  # Rely on filesystem compression
  CONFIG_MODULE_COMPRESS: n

  # For optimal v3d performance
  CONFIG_TRANSPARENT_HUGEPAGE: y
