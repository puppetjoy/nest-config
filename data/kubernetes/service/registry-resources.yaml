---
include:
  - 'nest::service::registry'

bucket_storage_class: ceph-bucket

resources:
  bucket:
    apiVersion: objectbucket.io/v1alpha1
    kind: ObjectBucketClaim
    metadata:
      name: "%{nest::kubernetes::main_service}-bucket" # used for the configmap and secret
      namespace: "%{nest::kubernetes::namespace}"
    spec:
      generateBucketName: "%{nest::kubernetes::main_service}"
      storageClassName: "%{lookup('bucket_storage_class')}"

  ui-secret:
    apiVersion: v1
    kind: Secret
    metadata:
      name: "%{nest::kubernetes::main_service}-ui"
      namespace: "%{nest::kubernetes::namespace}"
    data:
      SECRET_KEY_BASE: "%{nest::service::registry::ui_secret}"
      TOKEN_AUTH_PASSWORD: "%{nest::service::registry::admin_password_base64}"
