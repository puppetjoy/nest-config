---
service_name: chat

values:
  fullnameOverride: "%{nest::kubernetes::service}"
  librechat:
    configEnv:
      ALLOW_PASSWORD_RESET: 'true'
      ALLOW_REGISTRATION: 'true'
      EMAIL_FROM_NAME: 'LibreChat'
      EMAIL_FROM: "%{nest::kubernetes::service}@joyfullee.me"
      EMAIL_HOST: smtp.nest
      EMAIL_USERNAME: none
      EMAIL_PASSWORD: none
    configYamlContent: |
      version: 1.3.1

      registration:
        allowedDomains:
          - joyfullee.me

      interface:
        marketplace:
          use: false

      endpoints:
        custom:
          - name: LiteLLM
            apiKey: none
            baseURL: http://litellm/v1
            models:
              default:
                - gpt-oss-120b
                - qwen3-coder-30b
            titleConvo: true
            titleEndpoint: LiteLLM-Title
            titleModel: qwen25-util

          - name: LiteLLM-Title
            apiKey: none
            baseURL: http://litellm/v1
            models:
              default:
                - qwen25-util
            addParams:
              temperature: 0

          - name: LiteLLM-Vision
            apiKey: none
            baseURL: http://litellm/v1
            models:
              default:
                - gemma-3-4b

      fileConfig:
        endpoints:
          LiteLLM:
            supportedMimeTypes:
              - "^text/.*$"
              - "^application/pdf$"
              - "^application/json$"
              - "^text/markdown$"
              # (intentionally NO image/.* here)

          LiteLLM-Vision:
            supportedMimeTypes:
              - "image/.*"
              - "^text/.*$"
              - "^application/pdf$"

      modelSpecs:
        enforce: false
        prioritize: true
        list:
          - name: general
            label: GPT-OSS 120B
            default: true
            description: General-purpose chat
            preset:
              endpoint: LiteLLM
              model: gpt-oss-120b
              modelLabel: GPT
              temperature: 0.7
              maxContextTokens: 65536
              max_tokens: 4096
              greeting: |
                Ask questions, explore ideas, or have longer conversations.
              promptPrefix: |
                You are a friendly, practical assistant.

                Be direct and concise by default. Expand only when asked, or when detail is necessary to be correct.

                Prefer short paragraphs and bullet lists. Avoid tables unless the user explicitly requests one or the information truly requires tabular comparison.

          - name: coder
            label: Qwen3 Coder 30B
            description: Code-first assistant
            preset:
              endpoint: LiteLLM
              model: qwen3-coder-30b
              modelLabel: Qwen
              temperature: 0.2
              maxContextTokens: 65536
              max_tokens: 2048
              greeting: |
                Ask about programming, code explanations, or technical problems.

          - name: multi
            label: Gemma 3 4B
            description: Fast, multimodal assistant
            preset:
              endpoint: LiteLLM-Vision
              model: gemma-3-4b
              modelLabel: Gemma
              temperature: 0.7
              maxContextTokens: 65536
              max_tokens: 2048
              greeting: |
                Summarize, transform, and analyze text or images.
              promptPrefix: |
                You are a friendly, task-oriented assistant.

                You may be shown background context such as saved memories or prior facts about the user.
                These are provided for awareness only.

                Do NOT respond to, summarize, analyze, or comment on memories unless the user explicitly asks you to.
                Do NOT describe memory IDs, timestamps, or possible actions.

                Always respond only to the user's most recent message as a normal conversational reply.

      memory:
        disabled: false
        personalize: true
        tokenLimit: 1200
        charLimit: 10000
        messageWindowSize: 8
        validKeys:
          - personal_information
          - user_preferences
          - learned_facts
        agent:
          provider: LiteLLM
          model: qwen25-util
          instructions: |
            You are the Memory agent. Be strict and conservative.

            DEFAULT: Do not save anything.

            Save ONLY if the user explicitly asks, using phrases like:
            "remember", "save this", "store this", "keep in mind", "don't forget",
            OR explicitly says "my name is...", "call me...", "my pronouns are...", "I use ... pronouns", "I live in...".

            When saving, store ONE short sentence per memory item.

            Allowed keys:
            - personal_information: name, pronouns, gender identity (only if explicitly stated), location (city/region).
            - user_preferences: how the user wants to be addressed; response style preferences.
            - learned_facts: durable non-sensitive facts the user explicitly asks to remember.

            Do NOT store: secrets, credentials, addresses, phone numbers, health info, politics, or anything not explicitly requested.

            If the user corrects a saved item, overwrite it. If they ask to forget, delete it.
          model_parameters:
            temperature: 0.1
            max_tokens: 250
