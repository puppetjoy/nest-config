---
nest::classes:
  - 'nest::host::hawk'
  - 'nest::service::deskflow'
  - 'nest::service::gateway'
  - 'nest::service::gitlab'
  - 'nest::service::gitlab_runner'
  - 'nest::service::libvirt'

nest::dvorak: true
nest::gui_scaling_factor: 2.0

# Protect containers and virtual machines
nest::reset_filter_rules:
  - 'P /etc/cni/**'
  - 'P /etc/libvirt/**'
  - 'P /var/lib/cni/**'
  - 'P /var/lib/libvirt/**'

nest::hosts:
  gitlab.puppet:
    ip: '10.81.40.1'
  pe.puppet:
    ip: '10.81.40.10'
  cd.puppet:
    ip: '10.81.40.11'
  client.puppet:
    ip: '10.81.40.12'
  elclient.puppet:
    ip: '10.81.40.13'

nest::service::gateway::port_forwards:
  puppet-external:
    loopback: false
    port: 8140
    proto: tcp
    to_addr: '10.81.40.10'
    to_port: 8140
    zone: 'external'
  puppet-home:
    loopback: false
    port: 8140
    proto: tcp
    to_addr: '10.81.40.10'
    to_port: 8140
    zone: 'home'
  puppet-internal:
    loopback: false
    port: 8140
    proto: tcp
    to_addr: '10.81.40.10'
    to_port: 8140
    zone: 'internal'

nest::service::gitlab::external_name: 'gitlab.localhost'
nest::service::gitlab::image: 'registry.eyrie/nest/forks/gitlab:18.6.1-ce.0'
nest::service::gitlab::ssh_port: 2222
# nest::service::gitlab::gmail_password: ~

nest::service::gitlab_runner::host: 'gitlab.joyfullee.me'
nest::service::gitlab_runner::instances:
  builder:
    limit: 2
    bolt: true
    podman: true
    qemu: true
